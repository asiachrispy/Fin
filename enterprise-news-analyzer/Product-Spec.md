# 产品需求文档 (Product Specification)

## 项目概述

**项目名称**：全球突发事件影响分析系统

**一句话描述**：为企业高管提供全球突发事件的智能监控和业务影响分析服务

**目标**：帮助企业高管第一时间了解全球突发事件对自身业务的潜在影响，支持快速决策

## 目标用户

**核心用户群体**：企业高管（CEO、COO、CFO、业务负责人等）

**用户特征**：
- 年龄段：35-65 岁
- 技术水平：中等，熟悉 Web 浏览器操作，不需要编程知识
- 使用场景：每天早晨查看最新的全球突发事件及其对公司业务的影响分析
- 痛点：信息过载，无法从海量新闻中快速识别出影响自身业务的关键事件

## 核心功能

### 功能 1：全球新闻采集

**功能描述**：每天自动抓取全球主流新闻媒体的最新报道，为后续 AI 分析提供数据基础

**输入**：
- 新闻源配置：主流新闻媒体 URL 列表（BBC、CNN、路透社、彭博社等）
- 抓取时间：每天定时执行（默认时间：早上 8:00）
- 新闻范围：全球所有地区和领域

**输出**：
- 新闻列表：包含标题、正文、来源、发布时间、URL
- 抓取日志：成功抓取数量、失败源列表、错误信息

**业务规则**：
- 每天只抓取一次，避免过度抓取
- 优先抓取最新新闻（按发布时间排序）
- 如果某个源无法访问，记录错误日志，跳过该源，继续抓取其他源
- 每个新闻源最多抓取前 50 条新闻，避免数据量过大

**异常处理**：
- 新闻源无法访问（网络错误、反爬虫）：记录错误日志，跳过该源，继续抓取其他源
- 新闻内容格式异常：记录错误日志，跳过该条新闻
- 抓取超时（超过 30 秒）：放弃该源，继续抓取下一个源

**优先级**：高

**状态**：待开发

---

### 功能 2：AI 事件影响分析

**功能描述**：基于企业背景信息，使用 AI 分析每条新闻事件对企业业务的影响程度

**输入**：
- 新闻内容：标题、正文
- 企业背景信息：
  - 企业名称（字符串，必填）
  - 所属行业（下拉选择，如电商、金融、制造、科技等，可选填）
  - 主要业务（文本描述，可选填）
  - 主要市场（下拉选择，如北美、欧洲、亚太、全球等，可选填）
  - 竞争对手（文本，多个用逗号分隔，可选填）

**输出**：
- 影响程度分数：1-10 分（10 分表示影响最大）
- 影响说明：一段文字解释为什么有影响，以及具体影响是什么
- 分析状态：成功 / 无法分析

**业务规则**：
- 影响程度评分标准：
  - 1-3 分：低影响，事件对企业影响很小或间接影响
  - 4-6 分：中等影响，事件可能对企业有一定影响
  - 7-10 分：高影响，事件对企业有重大或直接影响
- 如果 AI 无法判断新闻与企业的关联性，标记为"无法分析"
- 允许用户只填写企业名称，其他字段选填，但 AI 分析准确性可能降低
- 每条新闻只分析一次，结果存入数据库

**异常处理**：
- AI 分析失败（API 错误、超时）：标记为"无法分析"，显示在列表中，不影响其他新闻的分析
- 用户输入信息不完整：允许提交，但在分析结果中提示"由于信息不完整，分析可能不准确"

**优先级**：高

**状态**：待开发

---

### 功能 3：Web 事件展示

**功能描述**：通过 Web 页面展示所有事件及其分析结果，支持查看详情和历史记录

**输入**：
- 筛选条件：
  - 日期范围（默认显示最近 7 天）
  - 影响程度（全部 / 低影响 1-3 / 中等影响 4-6 / 高影响 7-10）
  - 分析状态（全部 / 成功 / 无法分析）
  - 关键词搜索（搜索标题或影响说明）

**输出**：
- 事件列表页：
  - 每条事件显示：新闻标题、来源、发布时间、影响程度分数、分析状态
  - 支持按时间倒序排列
  - 支持点击进入详情页
- 事件详情页：
  - 新闻完整内容（标题、正文、来源、发布时间、原文链接）
  - 企业信息（企业名称、行业、业务、市场）
  - 分析结果（影响程度分数、影响说明）
  - 相关事件（同一事件的不同报道，如果有）

**业务规则**：
- 默认显示最近 7 天的所有事件
- 每页显示 20 条事件，支持翻页
- 高影响事件（7-10 分）在列表中高亮显示
- 点击事件可查看详情
- 历史数据保留 30 天，超过 30 天的事件自动删除

**异常处理**：
- 数据加载失败：显示错误提示，提供重试按钮
- 详情页不存在：显示"事件不存在或已被删除"，返回列表页

**优先级**：中

**状态**：待开发

---

### 功能 4：邮件推送（低优先级）

**功能描述**：每天将事件分析结果通过邮件发送给指定收件人（此功能暂缓开发）

**输入**：
- 邮件列表：用户在 Web 页面添加/删除的邮件地址
- 推送内容：所有事件分析结果
- 推送时间：每天抓取完成后自动发送（默认早上 8:00 后）

**输出**：
- 邮件：包含事件列表的 HTML 格式邮件
- 发送日志：成功/失败状态、失败原因

**业务规则**：
- 每天只发送一次
- 发送所有事件（不区分影响程度）
- 用户可以在 Web 页面管理邮件列表

**异常处理**：
- 邮件发送失败：记录错误日志，不影响系统其他功能
- 邮件地址无效：记录错误日志，跳过该地址，继续发送其他地址

**优先级**：低

**状态**：已规划，暂缓开发

---

## 功能优先级

### 高优先级（必须有）
1. **全球新闻采集** - 数据源是整个系统的基础，没有数据就无法分析
2. **AI 事件影响分析** - 核心功能，直接为用户提供价值

### 中优先级（应该有）
1. **Web 事件展示** - 用户需要通过界面查看分析结果

### 低优先级（可以有）
1. **邮件推送** - 用户可以自己登录网页查看，邮件推送是锦上添花

## AI增强功能

### AI增强 1：自动获取企业信息

**AI能力描述**：用户只需输入企业名称，AI 自动搜索并填充企业背景信息（行业、主要业务、主要市场等），用户只需确认或微调

**触发条件**：用户在"添加企业"页面输入企业名称后，自动触发

**输入**：
- 企业名称（字符串，如"亚马逊"）

**输出**：
- 企业背景信息：
  - 所属行业（如"电子商务"）
  - 主要业务（如"全球电商、云计算、数字流媒体"）
  - 主要市场（如"全球"）
  - 竞争对手（如"阿里巴巴、eBay、沃尔玛"）

**示例**：
- 用户输入："亚马逊"
- AI 返回：
  - 所属行业：电子商务
  - 主要业务：全球电商、云计算、数字流媒体
  - 主要市场：全球
  - 竞争对手：阿里巴巴、eBay、沃尔玛
- 用户确认或修改后提交

---

### AI增强 2：智能推送

**AI能力描述**：不是每天发送所有内容，而是 AI 判断事件重要性，只推送高影响事件（7 分以上），用户可自定义推送阈值

**触发条件**：每天抓取和分析完成后，自动触发

**输入**：
- 所有事件的分析结果
- 用户设置的推送阈值（默认 7 分）

**输出**：
- 智能筛选后的事件列表（只包含影响程度 ≥ 阈值的事件）
- 事件摘要（AI 生成的一段总结）

**示例**：
- 今天共分析 100 条新闻
- AI 判断其中 15 条影响程度 ≥ 7 分
- 只推送这 15 条高影响事件，并附上摘要："今天发现 15 条高影响事件，主要涉及供应链、政策变化、竞争对手动态"

---

### AI增强 3：事件聚类

**AI能力描述**：如果同一天有多条关于同一事件的新闻报道（如"亚马逊裁员"有 10 条不同报道），AI 自动聚合成一个事件，避免重复

**触发条件**：每天抓取和分析完成后，自动触发

**输入**：
- 所有新闻及其分析结果

**输出**：
- 聚类后的事件列表
- 每个聚类包含：原始新闻数量、代表性新闻（选最权威的来源）、所有来源列表

**示例**：
- 输入：10 条关于"亚马逊裁员"的新闻（来自 BBC、CNN、路透社等）
- 输出：
  - 事件名称：亚马逊裁员
  - 影响程度：8 分
  - 报道数量：10 条
  - 代表性新闻：来自路透社的报道
  - 所有来源：BBC、CNN、路透社、彭博社等

---

## 非功能性需求

### 性能要求
- 新闻抓取：每天一次，单次抓取完成时间 ≤ 10 分钟
- AI 分析：单条新闻分析时间 ≤ 5 秒
- Web 页面加载：首页加载时间 ≤ 2 秒
- 并发用户：支持 1-10 个用户同时访问（单用户系统）

### 安全要求
- 数据访问：不需要用户认证（单用户系统）
- API 密钥：AI 服务 API 密钥安全存储，不暴露在前端
- 数据备份：每天自动备份数据库

### 可用性要求
- 界面语言：中文
- 设备兼容：支持桌面浏览器（Chrome、Firefox、Safari、Edge），不需要移动端适配
- 错误提示：所有错误都有清晰的中文提示信息

### 兼容性要求
- 浏览器版本：支持近 2 年的主流浏览器版本
- 数据库：支持 SQLite（单用户场景，轻量级部署）

## 技术栈建议

### 前端
- **Vue 3**：用户指定，轻量级、易上手
- **Element Plus**：UI 组件库，快速搭建管理界面

### 后端
- **Python 3.10+**：用户指定
- **FastAPI**：用户指定，高性能异步框架
- **Celery + Redis**：定时任务（每天抓取新闻、发送邮件）

### 数据库
- **SQLite**：单用户场景，轻量级，无需独立数据库服务器

### AI服务
- **OpenAI API（GPT-4）**：用于事件影响分析和企业信息自动获取
- **备选方案**：Claude API（Anthropic）、Google Gemini API

### 新闻抓取
- **BeautifulSoup4**：HTML 解析
- **Requests**：HTTP 请求
- **Newspaper3k**：新闻文章提取（可选）

### 邮件发送
- **SMTP**：使用企业邮箱或第三方邮件服务（如 SendGrid）

## 附录

### 术语表
- **突发事件**：突然发生的、可能对企业业务产生影响的全球新闻事件
- **影响程度**：AI 评估的事件对企业业务的影响级别，范围 1-10 分
- **事件聚类**：将多个关于同一事件的新闻报道聚合为一个事件
- **推送阈值**：影响程度的最低分数，低于该分数的事件不推送

### 参考资料
- [FastAPI 官方文档](https://fastapi.tiangolo.com/)
- [Vue 3 官方文档](https://vuejs.org/)
- [OpenAI API 文档](https://platform.openai.com/docs)

---

**文档版本**：1.0.0

**最后更新**：2026-01-21

**下次更新计划**：功能开发完成后，根据实际使用情况迭代
